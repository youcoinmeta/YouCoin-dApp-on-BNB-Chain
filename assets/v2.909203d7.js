import{u as e,d as a,e as t,c as n}from"./contract.1adf2fa6.js";import{V as s,C as i,B as o,E as r,_ as c}from"./contract.1e3e3035.js";import{W as u,I as l,f as d,r as w,k as f}from"./index.0c2b9d6b.js";const v=r||c,g=new u,{utils:y}=g;function k(){const a=e();async function t(e){const t=new i(v,"0x1F88E9956c8f8F64c8D5fEF5eD8A818E2237112c"),n=await t.call("balanceOf",[a.account]),s=await t.call("allowance",[a.account,"0x3341391e8750ca8Db57F69570AfAf0319c6b93C3"]),r=-1===new o(s).comparedTo(new o(e)),c=!(-1===new o(n).comparedTo(new o(e)));return r?(a.changeTipV2(!0,"v2"),!1):(c||a.changeTipV2(!0,"v2"),c)}return{unstake:async function(e,a,n){y.bytesToHex(JSON.parse(JSON.stringify(e))),await t(n)&&await s.execute("abcdeunstake",[e,a])},activeUser:async function(){await s.execute("abcdeactive",[])},restake:async function(e){await s.execute("abcderestake",[e])},getSysParam:async function(e){return await s.call("getSysParam",[e])},getAccount:async function(e,a,t,n){try{return await s.call("getAccount",[e,a,t,n])}catch(i){}},stake:async function(e,a,t,n){try{return await s.execute("stake",[e,a,t,n])}catch(i){}},enableAutoReinvest:async function(e,a){await s.execute("enableAutoReinvest",[e,a])},withdrawKeepPool:async function(e,a){await s.execute("withdrawKeepPool",[e,a])},withdraw:async function(e){await t(e)&&await s.execute("withdraw",[])},issueNFT:async function(e){await s.execute("abcdeissueNFT",[e])},trigger:async function(e,a){if(await t(a))return await s.execute("abcdetrigger",[e])},addToken:async function(e){await s.execute("addToken",[e])}}}const{getSysParam:m,getAccount:h}=k(),{getAccountID:A,getUserAccount:p}=a();async function S(e,a){let t=[];const n=await h("0",e,a,!1),{orders:{orders:s,unfinish:i}}=n;if(t=t.concat(s),i){const a=s[s.length-1].link.id;let n=await S(e,a);t=t.concat(n)}return t}const T=l("v2",()=>{const e=t(),a=n(),s=d(()=>a.account),i=w(""),r=w("0"),c=w("0"),u=w("0"),l=w({avaiReward:"0",id:"0",level:"0",medalValue:"0",myselfAchieveLevel:"0",totalAffUsd:"0",totalReward:"0",needActive:"0",totalStakeAffWithdraw:"0",totalStakeUsd:"0",withdrawAddrs:[],migrateReward:"0",totalWithdrawUSD:"",migrateRewardUsd:"0"}),v=w([]),g=w({autoRestakeGapTime:"0",damagesRatio:"0",day:"300",lastStakeTime:"0",newOrderID:"0",noStakePauseDays:"0",sero:"0xBB18b3210eB0d8926fF89D339495F0940b736162",stake2Burn:"0",stake2DAO:"0",stake2Market:"0",stake2Sero:"0",stake2Share:"0",stake2UCON:"0",startTime:"1683775446",sysCoinAffAssignTotal:"0",sysCoinAffTotal:"0",sysCoinBoughtTotal:"0",sysCoinBurnTotal:"0",sysCoinDamages2Share:"0",sysCoinDamagesTotal:"0",sysCoinFeeBurnTotal:"0",sysCoinReplenish:"0",sysCoinRewardActually:"0",sysCoinStakeBurnTotal:"0",sysCoinTotalReward:"0",tradeFee:"0",triggleFee:"0",ubsInvestTotal:"0",ucon:"0xD755f05d67a4cc2Da81923ACdAE5640A9e863ABc",usdDecimal:"1000000",withdrawFee:"0",triggerFee:"0"}),y=w([]);f(s,async e=>{i.value=localStorage.getItem(s.value)||"Account",C()});const k=d(()=>{const{stake2Burn:e,stake2DAO:a,stake2Market:t,stake2Sero:n,stake2Share:s,stake2UCON:i}=g.value,r=new o(e).plus(new o(a)).plus(new o(t)).plus(new o(n)).plus(new o(s)).plus(new o(i)).times(new o(100));return new o(1e20).minus(r).toString(10)}),p=d(()=>{if("0"===r.value)return"0";return new o(g.value.withdrawFee).times(new o("1e18")).div(r.value).toString(10)}),T=d(()=>"0"===r.value?"0":new o(g.value.triggerFee).times(new o("1e18")).div(r.value).toString(10)),R=d(()=>{const{totalReward:e="0",totalAffReward:a="0",migrateReward:t="0"}=l.value;return new o(e).plus(new o(a)).plus(t).toString(10)});async function C(){if(!s.value)return;const{medalInfos:a,param:t,tokens:n}=await m(!1);g.value=t;let i,d=await A(s.value),w=[];if("0"!==d.id){const a=await h("0",s.value,"0x000000000000000000000000000000000000000000000000000000000000",!1),{accountInfo:t,atokens:n,orders:o}=a;w=await S(s.value,"0x000000000000000000000000000000000000000000000000000000000000"),l.value=t;const{issueMedalLevel:r,latestMedalLevel:c}=l.value;e.change(r,c),i=o,v.value=n}else l.value={avaiReward:"0",id:"0",level:"0",medalValue:"0",myselfAchieveLevel:"0",totalAffUsd:"0",totalReward:"0",needActive:"0",totalStakeAffWithdraw:"0",totalStakeUsd:"0",withdrawAddrs:[],migrateReward:"0",totalWithdrawUSD:"",migrateRewardUsd:"0"};const f=[];for(let e=0;e<n.length;e++){const a=n[e];let{name:t}=n[e];if("bSERO"===t&&(t="SERO"),"YouCoin"===t&&(t="UCON"),"Ethereum Token"===t&&(t="ETH"),"UCON"===t&&(r.value=n[e].ti.price),"SERO"===t&&(c.value=a.ti.price),"ETH"===t&&(u.value=o(a.ti.price).dividedBy("1000000").toString(10)),"0"!==d.id){const a=w.filter(a=>a.token.toLocaleLowerCase()===n[e].ti.addr.toLocaleLowerCase()),s={ati:v.value[e].ati,packages:v.value[e].packages,orders:{...i,orders:a}};f.push({...n[e],name:t,user:s})}else f.push({...n[e],name:t})}y.value=f}return{account:s,tokenList:y,stakeRate:k,accountInfo:l,userTokenList:v,price:r,seroPrice:c,ethPrice:u,withdrawFee:p,triggerFee:T,systemInfoV2:g,totalReward:R,getSystemInfo:C}});export{k as a,T as u};
