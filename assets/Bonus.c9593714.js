import{u as e,d as a}from"./system.abdb71fd.js";import{d as t,r as n,i as l,W as s,c as o,h as c,o as i,a as u,e as r,t as d,u as v,x as m,b as p,w as f,F as k,p as b,f as x,_ as w,g as U,y,j as S,s as h,z as g}from"./index.f3e191e6.js";import{c as $,ae as D,B as C,I,ad as R}from"./index.c5a6da3b.js";import{P as _}from"./index.e8603419.js";import{E as N}from"./el-popper.f2d6c787.js";import{E as O}from"./el-input.e51a5d57.js";import{a as B,u as j}from"./dao.ddc6e8a4.js";import{a as F}from"./utils.3adde824.js";import{A as T,D as E}from"./contract.ad5dde8a.js";import{D as P,_ as V}from"./DaoPopup.7724bf17.js";import"./index.49f522f0.js";import"./index.df7f4e08.js";import"./contract.28cee6e9.js";import"./tip.19e97a77.js";const Y=e=>(b("data-v-221be13a"),e=e(),x(),e),A=["disabled"],M={class:"popup-dao"},H={class:"title"},W={class:"input input-dao",style:{"margin-bottom":"10px"}},G={class:"max"},L={class:"input-left"},z=Y((()=>r("span",{class:""},"UCON",-1))),q={class:"balance"},J=Y((()=>r("div",{class:"border"},null,-1))),K={class:"text"},Q={class:"text"},X={class:"text"},Z={class:"text"},ee={class:"text"},ae=w(t({__name:"StakeDialog",emits:["change","max"],setup(t,{emit:b}){const x=e(),{stakeUcon:w}=B(),U=a(),y=j(),S=n("");l((async()=>{}));const h=n(null),g=n(!1);new s;const R=n(""),N=n(""),E=o((()=>U.account));c(E,(async e=>{e&&Y()}),{immediate:!0});const P=o((()=>{if(ae.value)return V.value.length>0;const{blockFlag:e}=y.accountInfo;return V.value.length>0&&"0"===e})),V=o((()=>{let e=[];return x.stakeList.forEach((a=>{let{level:t}=a;e.push(parseInt(t))})),e=e.sort(),e}));async function Y(){const e=await D.call("allowance",[E.value,"0x84EF0D09F9Ba4239976CC68cD6e549b5c8729dc1"]);S.value=e,N.value=await D.call("balanceOf",[E.value])}const ae=o((()=>"0"===S.value||1===new C(R.value).times("1e18").comparedTo(S.value))),te=o((()=>{if(ae.value)return!0;const{stakeUCON:e}=y.accountInfo,{minStakeUcon:a}=y.daoSystemInfo,t=new C(a).dividedBy(new C(1e18)).toString(10);if(new C(e).dividedBy(new C(1e18)).toString(10),"0"===e){return!(1===new C(R.value).comparedTo(new C(N.value)))&&!ae.value&&parseFloat(R.value)>=parseFloat(t)}return!(1===new C(R.value).comparedTo(new C(N.value)))&&!ae.value&&""!==R.value&&-1!==new C(e).plus(new C(R.value).times(new C(1e18))).comparedTo(a)})),ne=o((()=>y.daoSystemInfo.uconStakeIncrease)),le=o((()=>{if(ne.value.length>=2){return{value:`${$(ne.value[0].minStake)}~${$(ne.value[1].minStake)}`,rate:F(ne.value[0].increaseRate)}}return{value:0,rate:0}})),se=o((()=>{if(ne.value.length>=2){return{value:`${$(ne.value[1].minStake)}~${$(ne.value[2].minStake)}`,rate:F(ne.value[1].increaseRate)}}return{value:0,rate:0}})),oe=o((()=>{if(ne.value.length>=2){return{value:`${$(ne.value[2].minStake)}~${$(ne.value[3].minStake)}`,rate:F(ne.value[2].increaseRate)}}return{value:0,rate:0}})),ce=o((()=>{if(ne.value.length>=2){return{value:`${$(ne.value[3].minStake)}`,rate:F(ne.value[3].increaseRate)}}return{value:0,rate:0}}));function ie(e){parseFloat(e)<0?R.value="":1!==new C(e).times(1e18).comparedTo(new C(N.value))?R.value=e:R.value=new C(N.value).div(new C("10").exponentiatedBy(18)).decimalPlaces(6).toString(10)}async function ue(){if(ae.value){if(!P.value)return;await D.execute("approve",["0x84EF0D09F9Ba4239976CC68cD6e549b5c8729dc1",T]);const e=await D.call("allowance",[E.value,"0x84EF0D09F9Ba4239976CC68cD6e549b5c8729dc1"]);S.value=e}else{if(0===V.value.length)return;P.value&&(g.value=!0)}}async function re(){if(!te.value)return;if(ae.value)return void ue();const e=new C(R.value).times(new C("10").exponentiatedBy(18)).decimalPlaces(0).toString(10);await w(e),y.getSystemInfo(),Y(),de()}function de(){var e;null==(e=h.value)||e.scroll({top:0,behavior:"smooth"}),g.value=!1,R.value=""}return(e,a)=>{const t=I,n=O,l=_;return i(),u(k,null,[r("div",{class:m(["stake-btn",{"stake-btn-active":v(P)}]),disabled:!v(P),onClick:ue},d(v(ae)?e.$t("V1.Enable"):e.$t("V1.Stake")),11,A),p(l,{show:g.value,"onUpdate:show":a[1]||(a[1]=e=>g.value=e),position:"bottom","overlay-class":"popup-dao",teleport:"body",round:"",style:{height:"70%"},onClose:de},{default:f((()=>[r("div",M,[r("h4",H,[r("span",null,d(e.$t("DaoStake.title")),1),p(t,{name:"cross",onClick:a[0]||(a[0]=e=>g.value=!1)})]),r("div",{class:"popup-dao-content",ref_key:"el",ref:h},[r("div",W,[r("div",G,d(e.$t("DaoStake.title"))+" UCON",1),r("div",L,[p(n,{class:"value",type:"number","model-value":R.value,placeholder:"0",onInput:ie},null,8,["model-value"]),z])]),r("div",q,d(e.$t("DaoStake.balance"))+": "+d(v($)(N.value))+" UCON ",1),J,r("div",K,d(e.$t("DaoStake.text1",{value:v($)(v(y).daoSystemInfo.minStakeUcon)})),1),r("div",Q,d(e.$t("DaoStake.text2",{value:v(le).value,rate:v(le).rate})),1),r("div",X,d(e.$t("DaoStake.text3",{value:v(se).value,rate:v(se).rate})),1),r("div",Z,d(e.$t("DaoStake.text2",{value:v(oe).value,rate:v(oe).rate})),1),r("div",ee,d(e.$t("DaoStake.text2",{value:v(ce).value,rate:v(ce).rate})),1),r("div",{class:m(["btn",{btcActive:v(te)}]),onClick:re},d(v(ae)?e.$t("V1.Enable"):e.$t("V1.Stake")),3)],512)])])),_:1},8,["show"])],64)}}}),[["__scopeId","data-v-221be13a"]]),te={class:"popover-info"},ne={class:"popover-text"},le={class:"btn"},se={class:"text border"},oe={key:1,class:"btn"},ce={class:"text"},ie=w(t({__name:"RedeemBtn",setup(e){const a=j();return(e,t)=>{const n=N;return"0"!==v(a).accountInfo.processCount?(i(),U(n,{key:0,"popper-class":"popover-model",placement:"top",width:"328px",trigger:"hover","propper-style":"{background: blue}"},{reference:f((()=>[r("div",le,[r("span",se,d(e.$t("DaoRedeem.title")),1)])])),default:f((()=>[r("div",te,[r("div",ne,d(e.$t("DaoRedeem.text15")),1)])])),_:1})):(i(),u("div",oe,[r("span",ce,d(e.$t("DaoRedeem.title")),1)]))}}}),[["__scopeId","data-v-13de1a3a"]]),ue=e=>(b("data-v-4dea1465"),e=e(),x(),e),re={class:"text"},de={class:"input"},ve={class:"input-title"},me={class:"flex"},pe={class:"flex input-content"},fe=ue((()=>r("span",{style:{color:"#ba7c00"},class:""},"UCON",-1))),ke={class:"cell"},be={class:"cell-label"},xe={class:"cell"},we={class:"cell-label"},Ue={key:0,class:"desc"},ye=ue((()=>r("div",{class:"border"},null,-1))),Se={class:"text"},he={class:"text"},ge=w(t({__name:"RedeemDialog",emits:["change","max"],setup(e,{emit:a}){const t=j(),{unstakeUcon:l}=B(),s=o((()=>t.accountInfo)),c=o((()=>{const{blockFlag:e}=t.accountInfo;return"0"===s.value.stakeUCON&&t.isRedeem||"1"==e})),k=o((()=>new C(s.value.stakeUCON).minus(new C(t.daoSystemInfo.minStakeUcon)).toString(10))),b=o((()=>1===new C(w.value).times(new C(1e18)).comparedTo(new C(k.value)))),x=n(null),w=n(""),S=o((()=>{const e=s.value.stakeUCON;if(""===w.value)return!1;const a=1===new C(w.value).times(1e18).comparedTo(e);return"0"!==e&&!a&&"0"===s.value.processCount}));function h(e){parseFloat(e)<0?w.value="":1!==new C(e).times(1e18).comparedTo(new C(s.value.stakeUCON))?w.value=e:g()}function g(){w.value=new C(s.value.stakeUCON).div(new C("10").exponentiatedBy(18)).decimalPlaces(6).toString(10),a("change",w.value)}async function D(){var e;const a=new C(w.value).times(new C("1e18")).decimalPlaces(0).toString(10);await l(a,t.daoSystemInfo.unstakeBurnUcon),t.getSystemInfo(),null==(e=x.value)||e.handleClose()}return(e,a)=>{const n=O,l=V;return i(),U(P,{title:e.$t("DaoRedeem.title1")+" 1/2",classText:"stake-btn",disabled:v(c),ref_key:"el",ref:x},{content:f((()=>[r("div",de,[r("div",ve,d(e.$t("DaoRedeem.title"))+"UCON",1),r("div",me,[r("div",pe,[p(n,{class:"value input-redeem",type:"number","model-value":w.value,placeholder:"0",onInput:h},null,8,["model-value"]),fe]),r("p",{class:"max",onClick:g},d(e.$t("Max")),1)])]),r("div",ke,[r("span",be,d(e.$t("DaoRedeem.text1")),1),r("span",null,d(v($)(v(k)))+" UCON",1)]),r("div",xe,[r("span",we,d(e.$t("DaoRedeem.text2")),1),r("span",null,d(v($)(v(s).stakeUCON))+" UCON",1)]),v(b)?(i(),u("div",Ue,d(e.$t("DaoRedeem.text3",{value:v($)(v(k))})),1)):y("",!0),ye,r("div",Se,d(e.$t("DaoRedeem.text4",{day:v(t).dayUnstake,rate:v(F)(v(t).daoSystemInfo.dayUnstakeRate)})),1),r("div",he,d(e.$t("DaoRedeem.text5")),1),p(l,{fee:v(t).daoSystemInfo.unstakeBurnUcon},null,8,["fee"]),r("div",{class:m(["btn-confirm",{btcActive:v(S)}]),onClick:D},d(e.$t("Confirm")),3)])),default:f((()=>[v(c)?(i(),U(ie,{key:1})):(i(),u("div",{key:0,class:m(["btn",{"btn-active":!v(c)}])},[r("span",re,d(e.$t("DaoRedeem.title")),1)],2))])),_:1},8,["title","disabled"])}}}),[["__scopeId","data-v-4dea1465"]]),$e=e=>(b("data-v-276c0ae7"),e=e(),x(),e),De={class:"text"},Ce={key:0,class:"input"},Ie={class:"input-title"},Re={class:"number"},_e={key:1},Ne={class:"cell"},Oe=$e((()=>r("span",{class:"icon cell-icon icon-dao-20"},null,-1))),Be={class:"cell-label"},je={class:"cell"},Fe=$e((()=>r("span",{class:"icon cell-icon icon-dao-22"},null,-1))),Te={class:"cell-label"},Ee={class:"cell"},Pe=$e((()=>r("span",{class:"icon cell-icon icon-dao-21"},null,-1))),Ve={class:"cell-label"},Ye={class:"cell"},Ae=$e((()=>r("span",{class:"icon cell-icon icon-dao-19"},null,-1))),Me={class:"cell-label"},He=$e((()=>r("div",{class:"border"},null,-1))),We={class:"input"},Ge={class:"input-title"},Le={class:"number number2"},ze=w(t({__name:"Redeem2Dialog",emits:["change","max"],setup(e,{emit:a}){const t=j(),l=o((()=>t.daoSystemInfo)),s=o((()=>t.accountInfo)),{withdrawUnstakeUcon:c}=B(),k=n(null),b=o((()=>{const{blockFlag:e}=t.accountInfo;return!t.isRedeem||"0"!==e})),x=o((()=>{const{blockFlag:e,avaiUnstakeUcon:a}=t.accountInfo;return"0"!==a})),w=o((()=>{const{totalUnstakeUcon:e,pendingUnstakeUcon:a}=s.value;return new C(e).minus(a).toString(10)})),S=o((()=>{const{totalUnstakeUcon:e,pendingUnstakeUcon:a}=s.value;return"0"===e?"0":new C(w.value).div(e).times(new C(100)).decimalPlaces(2).toString(10)})),h=o((()=>{const{dayUnstakeRate:e}=l.value,{unstakeStartTime:a}=s.value,t=new C(1e18).div(new C(e));let n=new C(a).plus(t.times(new C(E))).toString(10);return R(n,"YYYY-MM-DD HH:mm:ss")})),g=o((()=>{const{dayUnstakeRate:e}=l.value;return new C(100).minus(S.value).div(new C(e).div(new C(1e16))).toString(10)})),D=o((()=>"0"!==s.value.avaiUnstakeUcon));async function I(){var e;D.value&&(await c(t.daoSystemInfo.unstakeWithdrawBurnUcon),null==(e=k.value)||e.handleClose(),t.getSystemInfo())}const _=o((()=>"0"!=s.value.totalUnstakeUcon&&"0"!=s.value.pendingUnstakeUcon));return(e,a)=>{const n=V;return i(),U(P,{ref_key:"el",ref:k,title:e.$t("DaoRedeem.title1")+" 2/2",classText:"stake-btn",disabled:v(b),height:v(_)?"80%":"50%"},{content:f((()=>["0"!=v(s).totalUnstakeUcon?(i(),u("div",Ce,[r("div",Ie,d(e.$t("DaoRedeem.text7")),1),r("span",Re,d(v($)(v(s).totalUnstakeUcon))+" UCON ",1)])):y("",!0),v(_)?(i(),u("div",_e,[r("div",Ne,[Oe,r("span",Be,d(e.$t("DaoRedeem.text8")),1),r("span",null,d(v(R)(v(s).unstakeStartTime,"YYYY-MM-DD HH:mm:ss")),1)]),r("div",je,[Fe,r("span",Te,d(e.$t("DaoRedeem.text9")),1),r("span",null,d(v(h)),1)]),r("div",Ee,[Pe,r("span",Ve,d(e.$t("DaoRedeem.text10")),1),r("span",null,d(v($)(v(w)))+" UCON ("+d(v(S))+"%)",1)]),r("div",Ye,[Ae,r("span",Me,d(e.$t("DaoRedeem.text11")),1),r("span",null,d(v($)(v(s).pendingUnstakeUcon))+" UCON("+d(e.$t("DaoRedeem.text14",{day:"0"===v(s).totalUnstakeUcon?"0":v(g)}))+") ",1)]),He])):y("",!0),r("div",We,[r("div",Ge,d(e.$t("DaoRedeem.text12")),1),r("span",Le,d(v($)(v(s).avaiUnstakeUcon))+" UCON ",1)]),p(n,{fee:v(t).daoSystemInfo.unstakeWithdrawBurnUcon},null,8,["fee"]),r("div",{class:m(["btn-confirm",{"btn-active":v(D)}]),onClick:I},d(e.$t("DaoRedeem.text13")),3)])),default:f((()=>[v(b)?(i(),U(ie,{key:1})):(i(),u("div",{key:0,class:m(["btn",{"btn-active":!v(b),"btn-avai":v(x)}])},[r("span",De,d(e.$t("DaoRedeem.title")),1)],2))])),_:1},8,["title","disabled","height"])}}}),[["__scopeId","data-v-276c0ae7"]]),qe=e=>(b("data-v-fe3a8a4b"),e=e(),x(),e),Je=qe((()=>r("i",{class:"icon icon-dao-17"},null,-1))),Ke=qe((()=>r("i",{class:"icon icon-large icon-dao-17"},null,-1))),Qe={class:"text"},Xe={class:"text"},Ze=w(t({__name:"RefreshGlobal",setup(e){const a=j(),{flushAccountStatus:t}=B(),l=n(null);async function s(){var e;await t(a.daoSystemInfo.shareRewardBurnUcon),a.getSystemInfo(),null==(e=l.value)||e.handleClose()}return(e,t)=>{const n=V;return i(),U(P,{title:e.$t("V1.Refresh"),classText:"stake-btn",disabled:!1,height:"60%",ref_key:"el",ref:l},{content:f((()=>[Ke,r("div",Qe,d(e.$t("Dao.text10")),1),r("div",Xe,d(e.$t("Dao.text11")),1),p(n,{fee:v(a).daoSystemInfo.voteProposalBurnUcon},null,8,["fee"]),r("div",{class:m(["btn-confirm",{btcActive:!0}]),onClick:s},d(e.$t("Confirm")),1)])),default:f((()=>[Je])),_:1},8,["title"])}}}),[["__scopeId","data-v-fe3a8a4b"]]),ea=e=>(b("data-v-be085402"),e=e(),x(),e),aa={class:"pa"},ta={class:"title"},na=ea((()=>r("i",{class:"icon icon-dao-6"},null,-1))),la={class:"number"},sa=ea((()=>r("div",null,null,-1))),oa={class:"desc"},ca=ea((()=>r("i",{class:"icon icon-dao-24"},null,-1))),ia={class:"number"},ua={class:"table"},ra={class:"table-title"},da={class:"table-cell"},va={class:"table-cell1"},ma={class:"set"},pa={class:"set-item"},fa={class:"set-item-left"},ka={class:"label"},ba={class:"number",style:{"margin-left":"10px"}},xa={class:"set-item-right"},wa={class:"set-item"},Ua={class:"bonus-detail-content-title2 flex"},ya={class:"m-l"},Sa={key:0},ha={class:"manage"},ga=w(t({__name:"Bonus",setup(a){let t=C.clone({ROUNDING_MODE:4});const n=e(),l=g(),s=j(),c=o((()=>s.accountInfo)),f=o((()=>c.value.voteDetail.slice(0,4))),b=o((()=>{let e=[];return n.stakeList.forEach((a=>{let{level:t}=a;e.push(parseInt(t))})),e=e.sort(),e})),x=o((()=>{let e=new t("0");for(let a=0;a<3;a++)e=e.plus(I(f.value[a+1],18));return"0"===e.toString(10)?"0":e.times(100).dividedBy(I(f.value[0],18)).toString(10)})),w=o((()=>{const{totalVote:e}=s.daoSystemInfo,a=c.value.totalVote;if("0"===e)return"0";return new t(a).div(new t(1e18)).decimalPlaces(0).toString(10)})),D=o((()=>{let e=new t("0");return f.value.forEach((a=>{e=e.plus(new t(a))})),e.toString(10)}));function I(e,a){const n=w.value,{stakeUCON:l,totalVote:s}=c.value;if("0"===s)return"0";new t(e).times(n).dividedBy(D.value);return new t(e).times(l).dividedBy(new t(1e36)).decimalPlaces(a||0).toString(10)}return o((()=>new t(w.value).div(100).div(new t(D.value).dividedBy(new t(1e18))).decimalPlaces(10).toString(10))),(e,a)=>(i(),u("div",aa,[r("h4",ta,[na,r("span",null,d(e.$t("Share.title1")),1),r("span",la,d(v(w)),1)]),sa,r("h5",oa,[ca,r("span",null,d(e.$t("Dao.text14")),1),r("span",ia,d(v(x))+"%",1)]),r("div",ua,[r("h4",ra,[S(d(e.$t("Share.text2"))+" ",1),p(Ze)])]),r("div",da,[r("span",null,d(e.$t("Share.text3")),1),r("span",null,d(e.$t("Share.text4")),1),r("span",null,d(e.$t("Share.text5")),1),r("span",null,d(e.$t("Share.text6")),1)]),r("div",va,[(i(!0),u(k,null,h(v(f),(e=>(i(),u("span",null,d(I(e)),1)))),256))]),r("div",ma,[r("div",pa,[r("div",fa,[r("span",ka,d(e.$t("Share.text7")),1),r("span",ba,d(v($)(v(c).stakeUCON)),1)]),r("div",xa,[p(ae),"0"===v(s).accountInfo.pendingUnstakeUcon&&"0"===v(s).accountInfo.avaiUnstakeUcon&&"0"===v(s).accountInfo.processCount?(i(),U(ge,{key:0})):(i(),U(ze,{key:1}))])]),r("div",wa,[r("h4",Ua,[r("span",ya,d(e.$t("Dao.text15")),1),(i(!0),u(k,null,h(v(b),(e=>(i(),u("i",{class:m(["icon","icon-u"+(e+1)])},null,2)))),256)),0===v(b).length?(i(),u("span",Sa,"N/A")):y("",!0)]),r("div",{class:"set-item-right",onClick:a[0]||(a[0]=e=>v(l).replace({name:"Nft"}))},[r("span",ha,d(e.$t("Share.text11")),1)])])])]))}}),[["__scopeId","data-v-be085402"]]);export{ga as default};
