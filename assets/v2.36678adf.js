import{u as e,b as a,c as t}from"./contract.ec193c60.js";import{V as n,C as s,B as i,u as o}from"./index.21bf8326.js";import{W as r,Q as c,f as u,r as l,k as d}from"./index.72d226ca.js";import{E as w}from"./ERC20.31929c0b.js";const f=w,v=new r,{utils:g}=v;function m(){const a=e();async function t(e){const t=new s(f,"0x1F88E9956c8f8F64c8D5fEF5eD8A818E2237112c"),n=await t.call("balanceOf",[a.account]),o=await t.call("allowance",[a.account,"0x3341391e8750ca8Db57F69570AfAf0319c6b93C3"]),r=-1===new i(o).comparedTo(new i(e)),c=!(-1===new i(n).comparedTo(new i(e)));return r?(a.changeTipV2(!0,"v2"),!1):(c||a.changeTipV2(!0,"v2"),c)}return{unstake:async function(e,a,s){g.bytesToHex(JSON.parse(JSON.stringify(e))),await t(s)&&await n.execute("abcdeunstake",[e,a])},activeUser:async function(){await n.execute("abcdeactive",[])},restake:async function(e){await n.execute("abcderestake",[e])},getSysParam:async function(e){return await n.call("getSysParam",[e])},getAccount:async function(e,a,t,s){try{return await n.call("getAccount",[e,a,t,s])}catch(i){}},stake:async function(e,a,t,s){try{return await n.execute("stake",[e,a,t,s])}catch(i){}},enableAutoReinvest:async function(e,a){await n.execute("enableAutoReinvest",[e,a])},withdrawKeepPool:async function(e,a){await n.execute("withdrawKeepPool",[e,a])},withdraw:async function(e){await t(e)&&await n.execute("withdraw",[])},issueNFT:async function(e){await n.execute("abcdeissueNFT",[e])},trigger:async function(e,a){if(await t(a))return await n.execute("abcdetrigger",[e])},addToken:async function(e){await n.execute("addToken",[e])}}}const{getSysParam:y,getAccount:k}=m(),{getAccountID:h,getUserAccount:A}=a();async function p(e,a){let t=[];const n=await k("0",e,a,!1),{orders:{orders:s,unfinish:i}}=n;if(t=t.concat(s),i){const a=s[s.length-1].link.id;let n=await p(e,a);t=t.concat(n)}return t}const S=c("v2",(()=>{const e=t(),a=o(),n=u((()=>a.account)),s=l(""),r=l("0"),c=l("0"),w=l("0"),f=l({avaiReward:"0",id:"0",level:"0",medalValue:"0",myselfAchieveLevel:"0",totalAffUsd:"0",totalReward:"0",needActive:"0",totalStakeAffWithdraw:"0",totalStakeUsd:"0",withdrawAddrs:[],migrateReward:"0",totalWithdrawUSD:"",migrateRewardUsd:"0"}),v=l([]),g=l({autoRestakeGapTime:"0",damagesRatio:"0",day:"300",lastStakeTime:"0",newOrderID:"0",noStakePauseDays:"0",sero:"0xBB18b3210eB0d8926fF89D339495F0940b736162",stake2Burn:"0",stake2DAO:"0",stake2Market:"0",stake2Sero:"0",stake2Share:"0",stake2UCON:"0",startTime:"1683775446",sysCoinAffAssignTotal:"0",sysCoinAffTotal:"0",sysCoinBoughtTotal:"0",sysCoinBurnTotal:"0",sysCoinDamages2Share:"0",sysCoinDamagesTotal:"0",sysCoinFeeBurnTotal:"0",sysCoinReplenish:"0",sysCoinRewardActually:"0",sysCoinStakeBurnTotal:"0",sysCoinTotalReward:"0",tradeFee:"0",triggleFee:"0",ubsInvestTotal:"0",ucon:"0xD755f05d67a4cc2Da81923ACdAE5640A9e863ABc",usdDecimal:"1000000",withdrawFee:"0",triggerFee:"0"}),m=l([]);d(n,(async e=>{s.value=localStorage.getItem(n.value)||"Account",C()}));const A=u((()=>{const{stake2Burn:e,stake2DAO:a,stake2Market:t,stake2Sero:n,stake2Share:s,stake2UCON:o}=g.value,r=new i(e).plus(new i(a)).plus(new i(t)).plus(new i(n)).plus(new i(s)).plus(new i(o)).times(new i(100));return new i(1e20).minus(r).toString(10)})),S=u((()=>{if("0"===r.value)return"0";return new i(g.value.withdrawFee).times(new i("1e18")).div(r.value).toString(10)})),T=u((()=>"0"===r.value?"0":new i(g.value.triggerFee).times(new i("1e18")).div(r.value).toString(10))),R=u((()=>{const{totalReward:e="0",totalAffReward:a="0",migrateReward:t="0"}=f.value;return new i(e).plus(new i(a)).plus(t).toString(10)}));async function C(){if(!n.value)return;const{medalInfos:a,param:t,tokens:s}=await y(!1);g.value=t;let o,u=await h(n.value),l=[];if("0"!==u.id){const a=await k("0",n.value,"0x000000000000000000000000000000000000000000000000000000000000",!1),{accountInfo:t,atokens:s,orders:i}=a;l=await p(n.value,"0x000000000000000000000000000000000000000000000000000000000000"),f.value=t;const{issueMedalLevel:r,latestMedalLevel:c}=f.value;e.change(r,c),o=i,v.value=s}else f.value={avaiReward:"0",id:"0",level:"0",medalValue:"0",myselfAchieveLevel:"0",totalAffUsd:"0",totalReward:"0",needActive:"0",totalStakeAffWithdraw:"0",totalStakeUsd:"0",withdrawAddrs:[],migrateReward:"0",totalWithdrawUSD:"",migrateRewardUsd:"0"};const d=[];for(let e=0;e<s.length;e++){const a=s[e];let{name:t}=s[e];if("bSERO"===t&&(t="SERO"),"YouCoin"===t&&(t="UCON"),"Ethereum Token"===t&&(t="ETH"),"UCON"===t&&(r.value=s[e].ti.price),"SERO"===t&&(c.value=a.ti.price),"ETH"===t&&(w.value=i(a.ti.price).dividedBy("1000000").toString(10)),"0"!==u.id){const a=l.filter((a=>a.token.toLocaleLowerCase()===s[e].ti.addr.toLocaleLowerCase())),n={ati:v.value[e].ati,packages:v.value[e].packages,orders:{...o,orders:a}};d.push({...s[e],name:t,user:n})}else d.push({...s[e],name:t})}m.value=d}return{account:n,tokenList:m,stakeRate:A,accountInfo:f,userTokenList:v,price:r,seroPrice:c,ethPrice:w,withdrawFee:S,triggerFee:T,systemInfoV2:g,totalReward:R,getSystemInfo:C}}));export{m as a,S as u};
