import{u as e}from"./contract.5530be4f.js";import{d as a,r as t,l as n,W as l,f as s,k as o,o as c,c as i,b as u,t as r,u as d,n as v,g as m,w as p,F as f,p as k,h as b,_ as w,i as x,z as U,a as y,y as S,A as g}from"./index.46f1a6b1.js";import{u as h,c as $,U as D,B as C,W as I}from"./index.ad612a16.js";import{I as R}from"./index.7dde6c86.js";import{P as _}from"./index.b019cca2.js";import"./el-popper.7cffbf87.js";import{E as N}from"./el-input.2f0d8343.js";import{a as O,u as B}from"./dao.ed3df96a.js";import{a as j}from"./utils.cc3cecdf.js";import{A as F,D as T}from"./contract.cfb15a02.js";import{D as E,_ as P}from"./DaoPopup.709ee125.js";import{E as V}from"./el-popover.a8d2bbf3.js";import"./ERC20.31929c0b.js";import"./plugin-vue_export-helper.d1404625.js";import"./index.afc52389.js";import"./index.f75397a5.js";import"./tip.0e76733b.js";const Y=e=>(k("data-v-221be13a"),e=e(),b(),e),A=["disabled"],M={class:"popup-dao"},H={class:"title"},W={class:"input input-dao",style:{"margin-bottom":"10px"}},G={class:"max"},L={class:"input-left"},z=Y((()=>u("span",{class:""},"UCON",-1))),q={class:"balance"},J=Y((()=>u("div",{class:"border"},null,-1))),K={class:"text"},Q={class:"text"},X={class:"text"},Z={class:"text"},ee={class:"text"},ae=w(a({__name:"StakeDialog",emits:["change","max"],setup(a,{emit:k}){const b=e(),{stakeUcon:w}=O(),x=h(),U=B(),y=t("");n((async()=>{}));const S=t(null),g=t(!1);new l;const I=t(""),T=t(""),E=s((()=>x.account));o(E,(async e=>{e&&Y()}),{immediate:!0});const P=s((()=>{if(ae.value)return V.value.length>0;const{blockFlag:e}=U.accountInfo;return V.value.length>0&&"0"===e})),V=s((()=>{let e=[];return b.stakeList.forEach((a=>{let{level:t}=a;e.push(parseInt(t))})),e=e.sort(),e}));async function Y(){const e=await D.call("allowance",[E.value,"0x84EF0D09F9Ba4239976CC68cD6e549b5c8729dc1"]);y.value=e,T.value=await D.call("balanceOf",[E.value])}const ae=s((()=>"0"===y.value||1===new C(I.value).times("1e18").comparedTo(y.value))),te=s((()=>{if(ae.value)return!0;const{stakeUCON:e}=U.accountInfo,{minStakeUcon:a}=U.daoSystemInfo,t=new C(a).dividedBy(new C(1e18)).toString(10);if(new C(e).dividedBy(new C(1e18)).toString(10),"0"===e){return!(1===new C(I.value).comparedTo(new C(T.value)))&&!ae.value&&parseFloat(I.value)>=parseFloat(t)}return!(1===new C(I.value).comparedTo(new C(T.value)))&&!ae.value&&""!==I.value&&-1!==new C(e).plus(new C(I.value).times(new C(1e18))).comparedTo(a)})),ne=s((()=>U.daoSystemInfo.uconStakeIncrease)),le=s((()=>{if(ne.value.length>=2){return{value:`${$(ne.value[0].minStake)}~${$(ne.value[1].minStake)}`,rate:j(ne.value[0].increaseRate)}}return{value:0,rate:0}})),se=s((()=>{if(ne.value.length>=2){return{value:`${$(ne.value[1].minStake)}~${$(ne.value[2].minStake)}`,rate:j(ne.value[1].increaseRate)}}return{value:0,rate:0}})),oe=s((()=>{if(ne.value.length>=2){return{value:`${$(ne.value[2].minStake)}~${$(ne.value[3].minStake)}`,rate:j(ne.value[2].increaseRate)}}return{value:0,rate:0}})),ce=s((()=>{if(ne.value.length>=2){return{value:`${$(ne.value[3].minStake)}`,rate:j(ne.value[3].increaseRate)}}return{value:0,rate:0}}));function ie(e){parseFloat(e)<0?I.value="":1!==new C(e).times(1e18).comparedTo(new C(T.value))?I.value=e:I.value=new C(T.value).div(new C("10").exponentiatedBy(18)).decimalPlaces(6).toString(10)}async function ue(){if(ae.value){if(!P.value)return;await D.execute("approve",["0x84EF0D09F9Ba4239976CC68cD6e549b5c8729dc1",F]);const e=await D.call("allowance",[E.value,"0x84EF0D09F9Ba4239976CC68cD6e549b5c8729dc1"]);y.value=e}else{if(0===V.value.length)return;P.value&&(g.value=!0)}}async function re(){if(!te.value)return;if(ae.value)return void ue();const e=new C(I.value).times(new C("10").exponentiatedBy(18)).decimalPlaces(0).toString(10);await w(e),U.getSystemInfo(),Y(),de()}function de(){S.value?.scroll({top:0,behavior:"smooth"}),g.value=!1,I.value=""}return(e,a)=>{const t=R,n=N,l=_;return c(),i(f,null,[u("div",{class:v(["stake-btn",{"stake-btn-active":d(P)}]),disabled:!d(P),onClick:ue},r(d(ae)?e.$t("V1.Enable"):e.$t("V1.Stake")),11,A),m(l,{show:g.value,"onUpdate:show":a[1]||(a[1]=e=>g.value=e),position:"bottom","overlay-class":"popup-dao",teleport:"body",round:"",style:{height:"70%"},onClose:de},{default:p((()=>[u("div",M,[u("h4",H,[u("span",null,r(e.$t("DaoStake.title")),1),m(t,{name:"cross",onClick:a[0]||(a[0]=e=>g.value=!1)})]),u("div",{class:"popup-dao-content",ref_key:"el",ref:S},[u("div",W,[u("div",G,r(e.$t("DaoStake.title"))+" UCON",1),u("div",L,[m(n,{class:"value",type:"number","model-value":I.value,placeholder:"0",onInput:ie},null,8,["model-value"]),z])]),u("div",q,r(e.$t("DaoStake.balance"))+": "+r(d($)(T.value))+" UCON ",1),J,u("div",K,r(e.$t("DaoStake.text1",{value:d($)(d(U).daoSystemInfo.minStakeUcon)})),1),u("div",Q,r(e.$t("DaoStake.text2",{value:d(le).value,rate:d(le).rate})),1),u("div",X,r(e.$t("DaoStake.text3",{value:d(se).value,rate:d(se).rate})),1),u("div",Z,r(e.$t("DaoStake.text2",{value:d(oe).value,rate:d(oe).rate})),1),u("div",ee,r(e.$t("DaoStake.text2",{value:d(ce).value,rate:d(ce).rate})),1),u("div",{class:v(["btn",{btcActive:d(te)}]),onClick:re},r(d(ae)?e.$t("V1.Enable"):e.$t("V1.Stake")),3)],512)])])),_:1},8,["show"])],64)}}}),[["__scopeId","data-v-221be13a"]]),te={class:"popover-info"},ne={class:"popover-text"},le={class:"btn"},se={class:"text border"},oe={key:1,class:"btn"},ce={class:"text"},ie=w(a({__name:"RedeemBtn",setup(e){const a=B();return(e,t)=>{const n=V;return"0"!==d(a).accountInfo.processCount?(c(),x(n,{key:0,"popper-class":"popover-model",placement:"top",width:"328px",trigger:"hover","propper-style":"{background: blue}"},{reference:p((()=>[u("div",le,[u("span",se,r(e.$t("DaoRedeem.title")),1)])])),default:p((()=>[u("div",te,[u("div",ne,r(e.$t("DaoRedeem.text15")),1)])])),_:1})):(c(),i("div",oe,[u("span",ce,r(e.$t("DaoRedeem.title")),1)]))}}}),[["__scopeId","data-v-13de1a3a"]]),ue=e=>(k("data-v-4dea1465"),e=e(),b(),e),re={class:"text"},de={class:"input"},ve={class:"input-title"},me={class:"flex"},pe={class:"flex input-content"},fe=ue((()=>u("span",{style:{color:"#ba7c00"},class:""},"UCON",-1))),ke={class:"cell"},be={class:"cell-label"},we={class:"cell"},xe={class:"cell-label"},Ue={key:0,class:"desc"},ye=ue((()=>u("div",{class:"border"},null,-1))),Se={class:"text"},ge={class:"text"},he=w(a({__name:"RedeemDialog",emits:["change","max"],setup(e,{emit:a}){const n=B(),{unstakeUcon:l}=O(),o=s((()=>n.accountInfo)),f=s((()=>{const{blockFlag:e}=n.accountInfo;return"0"===o.value.stakeUCON&&n.isRedeem||"1"==e})),k=s((()=>new C(o.value.stakeUCON).minus(new C(n.daoSystemInfo.minStakeUcon)).toString(10))),b=s((()=>1===new C(y.value).times(new C(1e18)).comparedTo(new C(k.value)))),w=t(null),y=t(""),S=s((()=>{const e=o.value.stakeUCON;if(""===y.value)return!1;const a=1===new C(y.value).times(1e18).comparedTo(e);return"0"!==e&&!a&&"0"===o.value.processCount}));function g(e){parseFloat(e)<0?y.value="":1!==new C(e).times(1e18).comparedTo(new C(o.value.stakeUCON))?y.value=e:h()}function h(){y.value=new C(o.value.stakeUCON).div(new C("10").exponentiatedBy(18)).decimalPlaces(6).toString(10),a("change",y.value)}async function D(){const e=new C(y.value).times(new C("1e18")).decimalPlaces(0).toString(10);await l(e,n.daoSystemInfo.unstakeBurnUcon),n.getSystemInfo(),w.value?.handleClose()}return(e,a)=>{const t=N,l=P;return c(),x(E,{title:e.$t("DaoRedeem.title1")+" 1/2",classText:"stake-btn",disabled:d(f),ref_key:"el",ref:w},{content:p((()=>[u("div",de,[u("div",ve,r(e.$t("DaoRedeem.title"))+"UCON",1),u("div",me,[u("div",pe,[m(t,{class:"value input-redeem",type:"number","model-value":y.value,placeholder:"0",onInput:g},null,8,["model-value"]),fe]),u("p",{class:"max",onClick:h},r(e.$t("Max")),1)])]),u("div",ke,[u("span",be,r(e.$t("DaoRedeem.text1")),1),u("span",null,r(d($)(d(k)))+" UCON",1)]),u("div",we,[u("span",xe,r(e.$t("DaoRedeem.text2")),1),u("span",null,r(d($)(d(o).stakeUCON))+" UCON",1)]),d(b)?(c(),i("div",Ue,r(e.$t("DaoRedeem.text3",{value:d($)(d(k))})),1)):U("",!0),ye,u("div",Se,r(e.$t("DaoRedeem.text4",{day:d(n).dayUnstake,rate:d(j)(d(n).daoSystemInfo.dayUnstakeRate)})),1),u("div",ge,r(e.$t("DaoRedeem.text5")),1),m(l,{fee:d(n).daoSystemInfo.unstakeBurnUcon},null,8,["fee"]),u("div",{class:v(["btn-confirm",{btcActive:d(S)}]),onClick:D},r(e.$t("Confirm")),3)])),default:p((()=>[d(f)?(c(),x(ie,{key:1})):(c(),i("div",{key:0,class:v(["btn",{"btn-active":!d(f)}])},[u("span",re,r(e.$t("DaoRedeem.title")),1)],2))])),_:1},8,["title","disabled"])}}}),[["__scopeId","data-v-4dea1465"]]),$e=e=>(k("data-v-84fad9b6"),e=e(),b(),e),De={class:"text"},Ce={key:0,class:"input"},Ie={class:"input-title"},Re={class:"number"},_e={key:1},Ne={class:"cell"},Oe=$e((()=>u("span",{class:"icon cell-icon icon-dao-20"},null,-1))),Be={class:"cell-label"},je={class:"cell"},Fe=$e((()=>u("span",{class:"icon cell-icon icon-dao-22"},null,-1))),Te={class:"cell-label"},Ee={class:"cell"},Pe=$e((()=>u("span",{class:"icon cell-icon icon-dao-21"},null,-1))),Ve={class:"cell-label"},Ye={class:"cell"},Ae=$e((()=>u("span",{class:"icon cell-icon icon-dao-19"},null,-1))),Me={class:"cell-label"},He=$e((()=>u("div",{class:"border"},null,-1))),We={class:"input"},Ge={class:"input-title"},Le={class:"number number2"},ze=w(a({__name:"Redeem2Dialog",emits:["change","max"],setup(e,{emit:a}){const n=B(),l=s((()=>n.daoSystemInfo)),o=s((()=>n.accountInfo)),{withdrawUnstakeUcon:f}=O(),k=t(null),b=s((()=>{const{blockFlag:e}=n.accountInfo;return!n.isRedeem||"0"!==e})),w=s((()=>{const{blockFlag:e,avaiUnstakeUcon:a}=n.accountInfo;return"0"!==a})),y=s((()=>{const{totalUnstakeUcon:e,pendingUnstakeUcon:a}=o.value;return new C(e).minus(a).toString(10)})),S=s((()=>{const{totalUnstakeUcon:e,pendingUnstakeUcon:a}=o.value;return"0"===e?"0":new C(y.value).div(e).times(new C(100)).decimalPlaces(2).toString(10)})),g=s((()=>{const{dayUnstakeRate:e}=l.value,{unstakeStartTime:a}=o.value,t=new C(1e18).div(new C(e));let n=new C(a).plus(t.times(new C(T))).toString(10);return I(n,"YYYY-MM-DD HH:mm:ss")})),h=s((()=>{const{dayUnstakeRate:e}=l.value;return new C(100).minus(S.value).div(new C(e).div(new C(1e16))).toString(10)})),D=s((()=>"0"!==o.value.avaiUnstakeUcon));async function R(){D.value&&(await f(n.daoSystemInfo.unstakeWithdrawBurnUcon),k.value?.handleClose(),n.getSystemInfo())}const _=s((()=>"0"!=o.value.totalUnstakeUcon&&"0"!=o.value.pendingUnstakeUcon));return(e,a)=>{const t=P;return c(),x(E,{ref_key:"el",ref:k,title:e.$t("DaoRedeem.title1")+" 2/2",classText:"stake-btn",disabled:d(b),height:d(_)?"80%":"50%"},{content:p((()=>["0"!=d(o).totalUnstakeUcon?(c(),i("div",Ce,[u("div",Ie,r(e.$t("DaoRedeem.text7")),1),u("span",Re,r(d($)(d(o).totalUnstakeUcon))+" UCON ",1)])):U("",!0),d(_)?(c(),i("div",_e,[u("div",Ne,[Oe,u("span",Be,r(e.$t("DaoRedeem.text8")),1),u("span",null,r(d(I)(d(o).unstakeStartTime,"YYYY-MM-DD HH:mm:ss")),1)]),u("div",je,[Fe,u("span",Te,r(e.$t("DaoRedeem.text9")),1),u("span",null,r(d(g)),1)]),u("div",Ee,[Pe,u("span",Ve,r(e.$t("DaoRedeem.text10")),1),u("span",null,r(d($)(d(y)))+" UCON ("+r(d(S))+"%)",1)]),u("div",Ye,[Ae,u("span",Me,r(e.$t("DaoRedeem.text11")),1),u("span",null,r(d($)(d(o).pendingUnstakeUcon))+" UCON("+r(e.$t("DaoRedeem.text14",{day:"0"===d(o).totalUnstakeUcon?"0":d(h)}))+") ",1)]),He])):U("",!0),u("div",We,[u("div",Ge,r(e.$t("DaoRedeem.text12")),1),u("span",Le,r(d($)(d(o).avaiUnstakeUcon))+" UCON ",1)]),m(t,{fee:d(n).daoSystemInfo.unstakeWithdrawBurnUcon},null,8,["fee"]),u("div",{class:v(["btn-confirm",{"btn-active":d(D)}]),onClick:R},r(e.$t("DaoRedeem.text13")),3)])),default:p((()=>[d(b)?(c(),x(ie,{key:1})):(c(),i("div",{key:0,class:v(["btn",{"btn-active":!d(b),"btn-avai":d(w)}])},[u("span",De,r(e.$t("DaoRedeem.title")),1)],2))])),_:1},8,["title","disabled","height"])}}}),[["__scopeId","data-v-84fad9b6"]]),qe=e=>(k("data-v-fe3a8a4b"),e=e(),b(),e),Je=qe((()=>u("i",{class:"icon icon-dao-17"},null,-1))),Ke=qe((()=>u("i",{class:"icon icon-large icon-dao-17"},null,-1))),Qe={class:"text"},Xe={class:"text"},Ze=w(a({__name:"RefreshGlobal",setup(e){const a=B(),{flushAccountStatus:n}=O(),l=t(null);async function s(){await n(a.daoSystemInfo.shareRewardBurnUcon),a.getSystemInfo(),l.value?.handleClose()}return(e,t)=>{const n=P;return c(),x(E,{title:e.$t("V1.Refresh"),classText:"stake-btn",disabled:!1,height:"60%",ref_key:"el",ref:l},{content:p((()=>[Ke,u("div",Qe,r(e.$t("Dao.text10")),1),u("div",Xe,r(e.$t("Dao.text11")),1),m(n,{fee:d(a).daoSystemInfo.voteProposalBurnUcon},null,8,["fee"]),u("div",{class:v(["btn-confirm",{btcActive:!0}]),onClick:s},r(e.$t("Confirm")),1)])),default:p((()=>[Je])),_:1},8,["title"])}}}),[["__scopeId","data-v-fe3a8a4b"]]),ea=e=>(k("data-v-a4592f72"),e=e(),b(),e),aa={class:"pa"},ta={class:"title"},na=ea((()=>u("i",{class:"icon icon-dao-6"},null,-1))),la={class:"number"},sa=ea((()=>u("div",null,null,-1))),oa={class:"desc"},ca=ea((()=>u("i",{class:"icon icon-dao-24"},null,-1))),ia={class:"number"},ua={key:0},ra={class:"table","w-full":""},da={class:"table-title w-full","w-full":""},va={class:"table-cell"},ma={class:"table-cell1"},pa={class:"set"},fa={class:"set-item"},ka={class:"set-item-left"},ba={class:"label"},wa={class:"number",style:{"margin-left":"10px"}},xa={class:"set-item-right"},Ua={class:"set-item"},ya={class:"bonus-detail-content-title2 flex"},Sa={class:"m-l"},ga={key:0},ha={class:"manage"},$a=w(a({__name:"Bonus",setup(a){let t=C.clone({ROUNDING_MODE:4});const n=e(),l=g(),o=B(),p=s((()=>o.accountInfo)),k=s((()=>p.value.voteDetail.slice(0,4))),b=s((()=>p.value.voteDetail)),w=s((()=>{let e=[];return n.stakeList.forEach((a=>{let{level:t}=a;e.push(parseInt(t))})),e=e.sort(),e})),h=s((()=>{let e=new t("0");for(let a=0;a<3;a++)e=e.plus(_(b.value[a+1],18));return"0"===e.toString(10)?"0":e.times(100).dividedBy(_(k.value[0],18)).toString(10)})),D=s((()=>{let e=new t("0");return e=e.plus(_(b.value[4],18)),new t(e).times(100).dividedBy(_(k.value[0],18)).toString(10)})),I=s((()=>{const{totalVote:e}=o.daoSystemInfo,a=p.value.totalVote;if("0"===e)return"0";return new t(a).div(new t(1e18)).decimalPlaces(0).toString(10)})),R=s((()=>{let e=new t("0");return k.value.forEach((a=>{e=e.plus(new t(a))})),e.toString(10)}));function _(e,a){const n=I.value,{stakeUCON:l,totalVote:s}=p.value;if("0"===s)return"0";new t(e).times(n).dividedBy(R.value);return new t(e).times(l).dividedBy(new t(1e36)).decimalPlaces(a||0).toString(10)}return s((()=>new t(I.value).div(100).div(new t(R.value).dividedBy(new t(1e18))).decimalPlaces(10).toString(10))),(e,a)=>(c(),i("div",aa,[u("h4",ta,[na,u("span",null,r(e.$t("Share.title1")),1),u("span",la,r(d(I)),1)]),sa,u("h5",oa,[ca,u("span",null,r(e.$t("Dao.text14")),1),u("span",ia,[y(r(d(h)),1),d(b)&&0!=d(b)[4]?(c(),i("span",ua,"+"+r(d(D)),1)):U("",!0),y("%")])]),u("div",ra,[u("h4",da,[y(r(e.$t("Share.text2"))+" ",1),m(Ze)])]),u("div",va,[u("span",null,r(e.$t("Share.text3")),1),u("span",null,r(e.$t("Share.text4")),1),u("span",null,r(e.$t("Share.text5")),1),u("span",null,r(e.$t("Share.text6")),1)]),u("div",ma,[(c(!0),i(f,null,S(d(k),(e=>(c(),i("span",null,r(_(e)),1)))),256))]),u("div",pa,[u("div",fa,[u("div",ka,[u("span",ba,r(e.$t("Share.text7")),1),u("span",wa,r(d($)(d(p).stakeUCON)),1)]),u("div",xa,[m(ae),"0"===d(o).accountInfo.pendingUnstakeUcon&&"0"===d(o).accountInfo.avaiUnstakeUcon&&"0"===d(o).accountInfo.processCount?(c(),x(he,{key:0})):(c(),x(ze,{key:1}))])]),u("div",Ua,[u("h4",ya,[u("span",Sa,r(e.$t("Dao.text15")),1),(c(!0),i(f,null,S(d(w),(e=>(c(),i("i",{class:v(["icon","icon-u"+(e+1)])},null,2)))),256)),0===d(w).length?(c(),i("span",ga,"N/A")):U("",!0)]),u("div",{class:"set-item-right",onClick:a[0]||(a[0]=e=>d(l).replace({name:"Nft"}))},[u("span",ha,r(e.$t("Share.text11")),1)])])])]))}}),[["__scopeId","data-v-a4592f72"]]);export{$a as default};
