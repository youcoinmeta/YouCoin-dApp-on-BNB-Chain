import{u as e,G as o,k as t,L as a,r as n,B as s,C as l,d as r,g as c,T as i,a9 as u,q as d,v,H as p,f,R as m,l as y,A as h,D as b,F as w}from"./index.0c2b9d6b.js";import{i as I,f as k,g as x,e as O,n as g,t as C,u as S,c as z,h as B,j as P,w as T,m as A,k as j,I as L}from"./index.1a2a6857.js";import{k as X,o as Y,l as E,m as R}from"./index.5403ce05.js";function D(e,o){"scrollTop"in e?e.scrollTop=o:e.scrollTo(e.scrollX,o)}function H(){return window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0}function F(e){D(window,e),D(document.body,e)}const $=I();function M(){$&&F(H())}const N=e=>e.stopPropagation();function V(e,o){("boolean"!=typeof e.cancelable||e.cancelable)&&e.preventDefault(),o&&N(e)}function q(o){const t=e(o);if(!t)return!1;const a=window.getComputedStyle(t),n="none"===a.display,s=null===t.offsetParent&&"fixed"!==a.position;return n||s}const{width:G,height:K}=X(),J="van-hairline--top-bottom",Q=Symbol("van-form");const U=Symbol();function W(e){const a=o(U,null);a&&t(a,o=>{o&&e()})}function Z(e){const o=a();o&&O(o.proxy,e)}const _={show:Boolean,zIndex:g,overlay:C,duration:g,teleport:[String,Object],lockScroll:C,lazyRender:C,beforeClose:Function,overlayProps:Object,overlayStyle:Object,overlayClass:S,transitionAppear:Boolean,closeOnClickOverlay:C};function ee(){const e=n(0),o=n(0),t=n(0),a=n(0),s=n(0),l=n(0),r=n(""),c=n(!0),i=()=>{t.value=0,a.value=0,s.value=0,l.value=0,r.value="",c.value=!0};return{move:n=>{const i=n.touches[0];t.value=(i.clientX<0?0:i.clientX)-e.value,a.value=i.clientY-o.value,s.value=Math.abs(t.value),l.value=Math.abs(a.value);var u,d;(!r.value||s.value<10&&l.value<10)&&(r.value=(u=s.value,d=l.value,u>d?"horizontal":d>u?"vertical":"")),c.value&&(s.value>5||l.value>5)&&(c.value=!1)},start:t=>{i(),e.value=t.touches[0].clientX,o.value=t.touches[0].clientY},reset:i,startX:e,startY:o,deltaX:t,deltaY:a,offsetX:s,offsetY:l,direction:r,isVertical:()=>"vertical"===r.value,isHorizontal:()=>"horizontal"===r.value,isTap:c}}let oe=0;const te="van-overflow-hidden";function ae(e){const o=n(!1);return t(e,e=>{e&&(o.value=e)},{immediate:!0}),e=>()=>o.value?e():null}const ne=()=>{var e;const{scopeId:o}=(null==(e=a())?void 0:e.vnode)||{};return o?{[o]:""}:null},[se,le]=z("overlay");const re=T(r({name:se,inheritAttrs:!1,props:{show:Boolean,zIndex:g,duration:g,className:S,lockScroll:C,lazyRender:C,customStyle:Object,teleport:[String,Object]},setup(e,{attrs:o,slots:t}){const a=n(),s=ae(()=>e.show||!e.lazyRender)(()=>{var n;const s=O(B(e.zIndex),e.customStyle);return P(e.duration)&&(s.animationDuration=`${e.duration}s`),d(c("div",p({ref:a,style:s,class:[le(),e.className]},o),[null==(n=t.default)?void 0:n.call(t)]),[[v,e.show]])});return R("touchmove",o=>{e.lockScroll&&V(o,!0)},{target:a}),()=>{const o=c(i,{name:"van-fade",appear:!0},{default:s});return e.teleport?c(u,{to:e.teleport},{default:()=>[o]}):o}}})),ce=O({},_,{round:Boolean,position:A("center"),closeIcon:A("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:A("top-right"),destroyOnClose:Boolean,safeAreaInsetTop:Boolean,safeAreaInsetBottom:Boolean}),[ie,ue]=z("popup");const de=T(r({name:ie,inheritAttrs:!1,props:ce,emits:["open","close","opened","closed","keydown","update:show","clickOverlay","clickCloseIcon"],setup(e,{emit:o,attrs:a,slots:r}){let I,g;const C=n(),S=n(),z=ae(()=>e.show||!e.lazyRender),B=f(()=>{const o={zIndex:C.value};if(P(e.duration)){o["center"===e.position?"animationDuration":"transitionDuration"]=`${e.duration}s`}return o}),T=()=>{I||(I=!0,C.value=void 0!==e.zIndex?+e.zIndex:j(),o("open"))},A=()=>{I&&function(e,{args:o=[],done:t,canceled:a,error:n}){if(e){const s=e.apply(null,o);k(s)?s.then(e=>{e?t():a&&a()}).catch(n||x):s?t():a&&a()}else t()}(e.beforeClose,{done(){I=!1,o("close"),o("update:show",!1)}})},X=t=>{o("clickOverlay",t),e.closeOnClickOverlay&&A()},D=()=>{if(e.overlay){const o=O({show:e.show,class:e.overlayClass,zIndex:C.value,duration:e.duration,customStyle:e.overlayStyle,role:e.closeOnClickOverlay?"button":void 0,tabindex:e.closeOnClickOverlay?0:void 0},e.overlayProps);return c(re,p(o,ne(),{onClick:X}),{default:r["overlay-content"]})}},H=e=>{o("clickCloseIcon",e),A()},F=()=>{if(e.closeable)return c(L,{role:"button",tabindex:0,name:e.closeIcon,class:[ue("close-icon",e.closeIconPosition),"van-haptics-feedback"],classPrefix:e.iconPrefix,onClick:H},null)};let $;const M=()=>{$&&clearTimeout($),$=setTimeout(()=>{o("opened")})},N=()=>o("closed"),q=e=>o("keydown",e),G=z(()=>{var o;const{destroyOnClose:t,round:n,position:s,safeAreaInsetTop:l,safeAreaInsetBottom:i,show:u}=e;if(u||!t)return d(c("div",p({ref:S,style:B.value,role:"dialog",tabindex:0,class:[ue({round:n,[s]:s}),{"van-safe-area-top":l,"van-safe-area-bottom":i}],onKeydown:q},a,ne()),[null==(o=r.default)?void 0:o.call(r),F()]),[[v,u]])}),K=()=>{const{position:o,transition:t,transitionAppear:a}=e;return c(i,{name:t||("center"===o?"van-fade":`van-popup-slide-${o}`),appear:a,onAfterEnter:M,onAfterLeave:N},{default:G})};return t(()=>e.show,e=>{e&&!I&&(T(),0===a.tabindex&&m(()=>{var e;null==(e=S.value)||e.focus()})),!e&&I&&(I=!1,o("close"))}),Z({popupRef:S}),function(e,o){const a=ee(),n=o=>{a.move(o);const t=a.deltaY.value>0?"10":"01",n=E(o.target,e.value),{scrollHeight:s,offsetHeight:l,scrollTop:r}=n;let c="11";0===r?c=l>=s?"00":"01":r+l>=s&&(c="10"),"11"===c||!a.isVertical()||parseInt(c,2)&parseInt(t,2)||V(o,!0)},r=()=>{document.addEventListener("touchstart",a.start),document.addEventListener("touchmove",n,{passive:!1}),oe||document.body.classList.add(te),oe++},c=()=>{oe&&(document.removeEventListener("touchstart",a.start),document.removeEventListener("touchmove",n),oe--,oe||document.body.classList.remove(te))},i=()=>o()&&c();Y(()=>o()&&r()),s(i),l(i),t(o,e=>{e?r():c()})}(S,()=>e.show&&e.lockScroll),R("popstate",()=>{e.closeOnPopstate&&(A(),g=!1)}),y(()=>{e.show&&T()}),h(()=>{g&&(o("update:show",!0),g=!1)}),s(()=>{e.show&&e.teleport&&(A(),g=!0)}),b(U,()=>e.show),()=>e.teleport?c(u,{to:e.teleport},{default:()=>[D(),K()]}):c(w,null,[D(),K()])}}));export{J as B,Q as F,de as P,ee as a,K as b,N as c,ae as d,H as g,q as i,W as o,V as p,M as r,F as s,Z as u,G as w};
