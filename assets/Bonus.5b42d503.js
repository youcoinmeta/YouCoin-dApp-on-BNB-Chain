import{u as e,e as a}from"./contract.33812521.js";import{d as t,r as n,l,W as s,f as o,k as c,o as i,c as u,b as r,t as d,u as v,n as m,g as p,w as f,F as k,p as b,h as w,_ as x,i as U,z as y,a as S,y as g,A as h}from"./index.b9b8891c.js";import{U as $,B as D}from"./contract.2e12ebec.js";import{I as C}from"./index.e3573b62.js";import{P as I}from"./index.313e2529.js";import"./el-popper.a4d047ae.js";import{E as R}from"./el-input.bf21035d.js";import{c as _,D as N}from"./index.f6f59bf0.js";import{a as O,u as B}from"./dao.b17a8f69.js";import{a as j}from"./utils.8f2af8da.js";import{A as F,D as T}from"./contract.cfb15a02.js";import{D as E,_ as P}from"./DaoPopup.7e35dd44.js";import{E as V}from"./el-popover.58410ac5.js";import"./plugin-vue_export-helper.77e5bec8.js";import"./index.184b1246.js";import"./index.667b6b34.js";import"./tip.0c88d7c1.js";const Y=e=>(b("data-v-c6e62da2"),e=e(),w(),e),A=["disabled"],M={class:"popup-dao"},H={class:"title"},W={class:"input input-dao",style:{"margin-bottom":"10px"}},G={class:"max"},L={class:"input-left"},z=Y((()=>r("span",{class:""},"UCON",-1))),q={class:"balance"},J=Y((()=>r("div",{class:"border"},null,-1))),K={class:"text"},Q={class:"text"},X={class:"text"},Z={class:"text"},ee={class:"text"},ae=x(t({__name:"StakeDialog",emits:["change","max"],setup(t,{emit:b}){const w=e(),{stakeUcon:x}=O(),U=a(),y=B(),S=n("");l((async()=>{}));const g=n(null),h=n(!1);new s;const N=n(""),T=n(""),E=o((()=>U.account));c(E,(async e=>{e&&Y()}),{immediate:!0});const P=o((()=>{if(ae.value)return V.value.length>0;const{blockFlag:e}=y.accountInfo;return V.value.length>0&&"0"===e})),V=o((()=>{let e=[];return w.stakeList.forEach((a=>{let{level:t}=a;e.push(parseInt(t))})),e=e.sort(),e}));async function Y(){const e=await $.call("allowance",[E.value,"0x84EF0D09F9Ba4239976CC68cD6e549b5c8729dc1"]);S.value=e,T.value=await $.call("balanceOf",[E.value])}const ae=o((()=>"0"===S.value||1===new D(N.value).times("1e18").comparedTo(S.value))),te=o((()=>{if(ae.value)return!0;const{stakeUCON:e}=y.accountInfo,{minStakeUcon:a}=y.daoSystemInfo,t=new D(a).dividedBy(new D(1e18)).toString(10);if(new D(e).dividedBy(new D(1e18)).toString(10),"0"===e){return!(1===new D(N.value).comparedTo(new D(T.value)))&&!ae.value&&parseFloat(N.value)>=parseFloat(t)}return!(1===new D(N.value).comparedTo(new D(T.value)))&&!ae.value&&""!==N.value&&-1!==new D(e).plus(new D(N.value).times(new D(1e18))).comparedTo(a)})),ne=o((()=>y.daoSystemInfo.uconStakeIncrease)),le=o((()=>{if(ne.value.length>=2){return{value:`${_(ne.value[0].minStake)}~${_(ne.value[1].minStake)}`,rate:j(ne.value[0].increaseRate)}}return{value:0,rate:0}})),se=o((()=>{if(ne.value.length>=2){return{value:`${_(ne.value[1].minStake)}~${_(ne.value[2].minStake)}`,rate:j(ne.value[1].increaseRate)}}return{value:0,rate:0}})),oe=o((()=>{if(ne.value.length>=2){return{value:`${_(ne.value[2].minStake)}~${_(ne.value[3].minStake)}`,rate:j(ne.value[2].increaseRate)}}return{value:0,rate:0}})),ce=o((()=>{if(ne.value.length>=2){return{value:`${_(ne.value[3].minStake)}`,rate:j(ne.value[3].increaseRate)}}return{value:0,rate:0}}));function ie(e){parseFloat(e)<0?N.value="":1!==new D(e).times(1e18).comparedTo(new D(T.value))?N.value=e:N.value=new D(T.value).div(new D("10").exponentiatedBy(18)).decimalPlaces(6).toString(10)}async function ue(){if(ae.value){if(!P.value)return;await $.execute("approve",["0x84EF0D09F9Ba4239976CC68cD6e549b5c8729dc1",F]);const e=await $.call("allowance",[E.value,"0x84EF0D09F9Ba4239976CC68cD6e549b5c8729dc1"]);S.value=e}else{if(0===V.value.length)return;P.value&&(h.value=!0)}}async function re(){if(!te.value)return;if(ae.value)return void ue();const e=new D(N.value).times(new D("10").exponentiatedBy(18)).decimalPlaces(0).toString(10);await x(e),y.getSystemInfo(),Y(),de()}function de(){g.value?.scroll({top:0,behavior:"smooth"}),h.value=!1,N.value=""}return(e,a)=>{const t=C,n=R,l=I;return i(),u(k,null,[r("div",{class:m(["stake-btn",{"stake-btn-active":v(P)}]),disabled:!v(P),onClick:ue},d(v(ae)?e.$t("V1.Enable"):e.$t("V1.Stake")),11,A),p(l,{show:h.value,"onUpdate:show":a[1]||(a[1]=e=>h.value=e),position:"bottom","overlay-class":"popup-dao",teleport:"body",round:"",style:{height:"70%"},onClose:de},{default:f((()=>[r("div",M,[r("h4",H,[r("span",null,d(e.$t("DaoStake.title")),1),p(t,{name:"cross",onClick:a[0]||(a[0]=e=>h.value=!1)})]),r("div",{class:"popup-dao-content",ref_key:"el",ref:g},[r("div",W,[r("div",G,d(e.$t("DaoStake.title"))+" UCON",1),r("div",L,[p(n,{class:"value",type:"number","model-value":N.value,placeholder:"0",onInput:ie},null,8,["model-value"]),z])]),r("div",q,d(e.$t("DaoStake.balance"))+": "+d(v(_)(T.value))+" UCON ",1),J,r("div",K,d(e.$t("DaoStake.text1",{value:v(_)(v(y).daoSystemInfo.minStakeUcon)})),1),r("div",Q,d(e.$t("DaoStake.text2",{value:v(le).value,rate:v(le).rate})),1),r("div",X,d(e.$t("DaoStake.text3",{value:v(se).value,rate:v(se).rate})),1),r("div",Z,d(e.$t("DaoStake.text2",{value:v(oe).value,rate:v(oe).rate})),1),r("div",ee,d(e.$t("DaoStake.text2",{value:v(ce).value,rate:v(ce).rate})),1),r("div",{class:m(["btn",{btcActive:v(te)}]),onClick:re},d(v(ae)?e.$t("V1.Enable"):e.$t("V1.Stake")),3)],512)])])),_:1},8,["show"])],64)}}}),[["__scopeId","data-v-c6e62da2"]]),te={class:"popover-info"},ne={class:"popover-text"},le={class:"btn"},se={class:"text border"},oe={key:1,class:"btn"},ce={class:"text"},ie=x(t({__name:"RedeemBtn",setup(e){const a=B();return(e,t)=>{const n=V;return"0"!==v(a).accountInfo.processCount?(i(),U(n,{key:0,"popper-class":"popover-model",placement:"top",width:"328px",trigger:"hover","propper-style":"{background: blue}"},{reference:f((()=>[r("div",le,[r("span",se,d(e.$t("DaoRedeem.title")),1)])])),default:f((()=>[r("div",te,[r("div",ne,d(e.$t("DaoRedeem.text15")),1)])])),_:1})):(i(),u("div",oe,[r("span",ce,d(e.$t("DaoRedeem.title")),1)]))}}}),[["__scopeId","data-v-13de1a3a"]]),ue=e=>(b("data-v-4dea1465"),e=e(),w(),e),re={class:"text"},de={class:"input"},ve={class:"input-title"},me={class:"flex"},pe={class:"flex input-content"},fe=ue((()=>r("span",{style:{color:"#ba7c00"},class:""},"UCON",-1))),ke={class:"cell"},be={class:"cell-label"},we={class:"cell"},xe={class:"cell-label"},Ue={key:0,class:"desc"},ye=ue((()=>r("div",{class:"border"},null,-1))),Se={class:"text"},ge={class:"text"},he=x(t({__name:"RedeemDialog",emits:["change","max"],setup(e,{emit:a}){const t=B(),{unstakeUcon:l}=O(),s=o((()=>t.accountInfo)),c=o((()=>{const{blockFlag:e}=t.accountInfo;return"0"===s.value.stakeUCON&&t.isRedeem||"1"==e})),k=o((()=>new D(s.value.stakeUCON).minus(new D(t.daoSystemInfo.minStakeUcon)).toString(10))),b=o((()=>1===new D(x.value).times(new D(1e18)).comparedTo(new D(k.value)))),w=n(null),x=n(""),S=o((()=>{const e=s.value.stakeUCON;if(""===x.value)return!1;const a=1===new D(x.value).times(1e18).comparedTo(e);return"0"!==e&&!a&&"0"===s.value.processCount}));function g(e){parseFloat(e)<0?x.value="":1!==new D(e).times(1e18).comparedTo(new D(s.value.stakeUCON))?x.value=e:h()}function h(){x.value=new D(s.value.stakeUCON).div(new D("10").exponentiatedBy(18)).decimalPlaces(6).toString(10),a("change",x.value)}async function $(){const e=new D(x.value).times(new D("1e18")).decimalPlaces(0).toString(10);await l(e,t.daoSystemInfo.unstakeBurnUcon),t.getSystemInfo(),w.value?.handleClose()}return(e,a)=>{const n=R,l=P;return i(),U(E,{title:e.$t("DaoRedeem.title1")+" 1/2",classText:"stake-btn",disabled:v(c),ref_key:"el",ref:w},{content:f((()=>[r("div",de,[r("div",ve,d(e.$t("DaoRedeem.title"))+"UCON",1),r("div",me,[r("div",pe,[p(n,{class:"value input-redeem",type:"number","model-value":x.value,placeholder:"0",onInput:g},null,8,["model-value"]),fe]),r("p",{class:"max",onClick:h},d(e.$t("Max")),1)])]),r("div",ke,[r("span",be,d(e.$t("DaoRedeem.text1")),1),r("span",null,d(v(_)(v(k)))+" UCON",1)]),r("div",we,[r("span",xe,d(e.$t("DaoRedeem.text2")),1),r("span",null,d(v(_)(v(s).stakeUCON))+" UCON",1)]),v(b)?(i(),u("div",Ue,d(e.$t("DaoRedeem.text3",{value:v(_)(v(k))})),1)):y("",!0),ye,r("div",Se,d(e.$t("DaoRedeem.text4",{day:v(t).dayUnstake,rate:v(j)(v(t).daoSystemInfo.dayUnstakeRate)})),1),r("div",ge,d(e.$t("DaoRedeem.text5")),1),p(l,{fee:v(t).daoSystemInfo.unstakeBurnUcon},null,8,["fee"]),r("div",{class:m(["btn-confirm",{btcActive:v(S)}]),onClick:$},d(e.$t("Confirm")),3)])),default:f((()=>[v(c)?(i(),U(ie,{key:1})):(i(),u("div",{key:0,class:m(["btn",{"btn-active":!v(c)}])},[r("span",re,d(e.$t("DaoRedeem.title")),1)],2))])),_:1},8,["title","disabled"])}}}),[["__scopeId","data-v-4dea1465"]]),$e=e=>(b("data-v-84fad9b6"),e=e(),w(),e),De={class:"text"},Ce={key:0,class:"input"},Ie={class:"input-title"},Re={class:"number"},_e={key:1},Ne={class:"cell"},Oe=$e((()=>r("span",{class:"icon cell-icon icon-dao-20"},null,-1))),Be={class:"cell-label"},je={class:"cell"},Fe=$e((()=>r("span",{class:"icon cell-icon icon-dao-22"},null,-1))),Te={class:"cell-label"},Ee={class:"cell"},Pe=$e((()=>r("span",{class:"icon cell-icon icon-dao-21"},null,-1))),Ve={class:"cell-label"},Ye={class:"cell"},Ae=$e((()=>r("span",{class:"icon cell-icon icon-dao-19"},null,-1))),Me={class:"cell-label"},He=$e((()=>r("div",{class:"border"},null,-1))),We={class:"input"},Ge={class:"input-title"},Le={class:"number number2"},ze=x(t({__name:"Redeem2Dialog",emits:["change","max"],setup(e,{emit:a}){const t=B(),l=o((()=>t.daoSystemInfo)),s=o((()=>t.accountInfo)),{withdrawUnstakeUcon:c}=O(),k=n(null),b=o((()=>{const{blockFlag:e}=t.accountInfo;return!t.isRedeem||"0"!==e})),w=o((()=>{const{blockFlag:e,avaiUnstakeUcon:a}=t.accountInfo;return"0"!==a})),x=o((()=>{const{totalUnstakeUcon:e,pendingUnstakeUcon:a}=s.value;return new D(e).minus(a).toString(10)})),S=o((()=>{const{totalUnstakeUcon:e,pendingUnstakeUcon:a}=s.value;return"0"===e?"0":new D(x.value).div(e).times(new D(100)).decimalPlaces(2).toString(10)})),g=o((()=>{const{dayUnstakeRate:e}=l.value,{unstakeStartTime:a}=s.value,t=new D(1e18).div(new D(e));let n=new D(a).plus(t.times(new D(T))).toString(10);return N(n,"YYYY-MM-DD HH:mm:ss")})),h=o((()=>{const{dayUnstakeRate:e}=l.value;return new D(100).minus(S.value).div(new D(e).div(new D(1e16))).toString(10)})),$=o((()=>"0"!==s.value.avaiUnstakeUcon));async function C(){$.value&&(await c(t.daoSystemInfo.unstakeWithdrawBurnUcon),k.value?.handleClose(),t.getSystemInfo())}const I=o((()=>"0"!=s.value.totalUnstakeUcon&&"0"!=s.value.pendingUnstakeUcon));return(e,a)=>{const n=P;return i(),U(E,{ref_key:"el",ref:k,title:e.$t("DaoRedeem.title1")+" 2/2",classText:"stake-btn",disabled:v(b),height:v(I)?"80%":"50%"},{content:f((()=>["0"!=v(s).totalUnstakeUcon?(i(),u("div",Ce,[r("div",Ie,d(e.$t("DaoRedeem.text7")),1),r("span",Re,d(v(_)(v(s).totalUnstakeUcon))+" UCON ",1)])):y("",!0),v(I)?(i(),u("div",_e,[r("div",Ne,[Oe,r("span",Be,d(e.$t("DaoRedeem.text8")),1),r("span",null,d(v(N)(v(s).unstakeStartTime,"YYYY-MM-DD HH:mm:ss")),1)]),r("div",je,[Fe,r("span",Te,d(e.$t("DaoRedeem.text9")),1),r("span",null,d(v(g)),1)]),r("div",Ee,[Pe,r("span",Ve,d(e.$t("DaoRedeem.text10")),1),r("span",null,d(v(_)(v(x)))+" UCON ("+d(v(S))+"%)",1)]),r("div",Ye,[Ae,r("span",Me,d(e.$t("DaoRedeem.text11")),1),r("span",null,d(v(_)(v(s).pendingUnstakeUcon))+" UCON("+d(e.$t("DaoRedeem.text14",{day:"0"===v(s).totalUnstakeUcon?"0":v(h)}))+") ",1)]),He])):y("",!0),r("div",We,[r("div",Ge,d(e.$t("DaoRedeem.text12")),1),r("span",Le,d(v(_)(v(s).avaiUnstakeUcon))+" UCON ",1)]),p(n,{fee:v(t).daoSystemInfo.unstakeWithdrawBurnUcon},null,8,["fee"]),r("div",{class:m(["btn-confirm",{"btn-active":v($)}]),onClick:C},d(e.$t("DaoRedeem.text13")),3)])),default:f((()=>[v(b)?(i(),U(ie,{key:1})):(i(),u("div",{key:0,class:m(["btn",{"btn-active":!v(b),"btn-avai":v(w)}])},[r("span",De,d(e.$t("DaoRedeem.title")),1)],2))])),_:1},8,["title","disabled","height"])}}}),[["__scopeId","data-v-84fad9b6"]]),qe=e=>(b("data-v-fe3a8a4b"),e=e(),w(),e),Je=qe((()=>r("i",{class:"icon icon-dao-17"},null,-1))),Ke=qe((()=>r("i",{class:"icon icon-large icon-dao-17"},null,-1))),Qe={class:"text"},Xe={class:"text"},Ze=x(t({__name:"RefreshGlobal",setup(e){const a=B(),{flushAccountStatus:t}=O(),l=n(null);async function s(){await t(a.daoSystemInfo.shareRewardBurnUcon),a.getSystemInfo(),l.value?.handleClose()}return(e,t)=>{const n=P;return i(),U(E,{title:e.$t("V1.Refresh"),classText:"stake-btn",disabled:!1,height:"60%",ref_key:"el",ref:l},{content:f((()=>[Ke,r("div",Qe,d(e.$t("Dao.text10")),1),r("div",Xe,d(e.$t("Dao.text11")),1),p(n,{fee:v(a).daoSystemInfo.voteProposalBurnUcon},null,8,["fee"]),r("div",{class:m(["btn-confirm",{btcActive:!0}]),onClick:s},d(e.$t("Confirm")),1)])),default:f((()=>[Je])),_:1},8,["title"])}}}),[["__scopeId","data-v-fe3a8a4b"]]),ea=e=>(b("data-v-a4592f72"),e=e(),w(),e),aa={class:"pa"},ta={class:"title"},na=ea((()=>r("i",{class:"icon icon-dao-6"},null,-1))),la={class:"number"},sa=ea((()=>r("div",null,null,-1))),oa={class:"desc"},ca=ea((()=>r("i",{class:"icon icon-dao-24"},null,-1))),ia={class:"number"},ua={key:0},ra={class:"table","w-full":""},da={class:"table-title w-full","w-full":""},va={class:"table-cell"},ma={class:"table-cell1"},pa={class:"set"},fa={class:"set-item"},ka={class:"set-item-left"},ba={class:"label"},wa={class:"number",style:{"margin-left":"10px"}},xa={class:"set-item-right"},Ua={class:"set-item"},ya={class:"bonus-detail-content-title2 flex"},Sa={class:"m-l"},ga={key:0},ha={class:"manage"},$a=x(t({__name:"Bonus",setup(a){let t=D.clone({ROUNDING_MODE:4});const n=e(),l=h(),s=B(),c=o((()=>s.accountInfo)),f=o((()=>c.value.voteDetail.slice(0,4))),b=o((()=>c.value.voteDetail)),w=o((()=>{let e=[];return n.stakeList.forEach((a=>{let{level:t}=a;e.push(parseInt(t))})),e=e.sort(),e})),x=o((()=>{let e=new t("0");for(let a=0;a<3;a++)e=e.plus(R(b.value[a+1],18));return"0"===e.toString(10)?"0":e.times(100).dividedBy(R(f.value[0],18)).toString(10)})),$=o((()=>{let e=new t("0");return e=e.plus(R(b.value[4],18)),new t(e).times(100).dividedBy(R(f.value[0],18)).toString(10)})),C=o((()=>{const{totalVote:e}=s.daoSystemInfo,a=c.value.totalVote;if("0"===e)return"0";return new t(a).div(new t(1e18)).decimalPlaces(0).toString(10)})),I=o((()=>{let e=new t("0");return f.value.forEach((a=>{e=e.plus(new t(a))})),e.toString(10)}));function R(e,a){const n=C.value,{stakeUCON:l,totalVote:s}=c.value;if("0"===s)return"0";new t(e).times(n).dividedBy(I.value);return new t(e).times(l).dividedBy(new t(1e36)).decimalPlaces(a||0).toString(10)}return o((()=>new t(C.value).div(100).div(new t(I.value).dividedBy(new t(1e18))).decimalPlaces(10).toString(10))),(e,a)=>(i(),u("div",aa,[r("h4",ta,[na,r("span",null,d(e.$t("Share.title1")),1),r("span",la,d(v(C)),1)]),sa,r("h5",oa,[ca,r("span",null,d(e.$t("Dao.text14")),1),r("span",ia,[S(d(v(x)),1),v(b)&&0!=v(b)[4]?(i(),u("span",ua,"+"+d(v($)),1)):y("",!0),S("%")])]),r("div",ra,[r("h4",da,[S(d(e.$t("Share.text2"))+" ",1),p(Ze)])]),r("div",va,[r("span",null,d(e.$t("Share.text3")),1),r("span",null,d(e.$t("Share.text4")),1),r("span",null,d(e.$t("Share.text5")),1),r("span",null,d(e.$t("Share.text6")),1)]),r("div",ma,[(i(!0),u(k,null,g(v(f),(e=>(i(),u("span",null,d(R(e)),1)))),256))]),r("div",pa,[r("div",fa,[r("div",ka,[r("span",ba,d(e.$t("Share.text7")),1),r("span",wa,d(v(_)(v(c).stakeUCON)),1)]),r("div",xa,[p(ae),"0"===v(s).accountInfo.pendingUnstakeUcon&&"0"===v(s).accountInfo.avaiUnstakeUcon&&"0"===v(s).accountInfo.processCount?(i(),U(he,{key:0})):(i(),U(ze,{key:1}))])]),r("div",Ua,[r("h4",ya,[r("span",Sa,d(e.$t("Dao.text15")),1),(i(!0),u(k,null,g(v(w),(e=>(i(),u("i",{class:m(["icon","icon-u"+(e+1)])},null,2)))),256)),0===v(w).length?(i(),u("span",ga,"N/A")):y("",!0)]),r("div",{class:"set-item-right",onClick:a[0]||(a[0]=e=>v(l).replace({name:"Nft"}))},[r("span",ha,d(e.$t("Share.text11")),1)])])])]))}}),[["__scopeId","data-v-a4592f72"]]);export{$a as default};
